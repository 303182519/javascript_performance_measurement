<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="../lib/vis.css">
    <script src="../lib/jquery-2.1.3.js"></script>
    <script src="../lib/vis.js"></script>
    <style type="text/css">
        #mynetwork {
            width: 800px;
            height: 400px;
            border: 1px solid lightgray;
        }
    </style>
</head>
<body>
<div id="mynetwork"></div>

<script type="text/javascript">


    function traverse(node, nodes, edges) {

        if (!nodes.get(node.callUID)) {
            nodes.add({
                id: node.callUID,
                label: node.functionName
            })
        }


        if (node.children) {
            for (var i = 0; i < node.children.length; i++) {
                edges.add({
                    arrows: "to",
                    from: node.callUID,
                    to: node.children[i].callUID
                })
                traverse(node.children[i], nodes, edges)
            }
        }
    }

    $.getJSON("condition.cpuprofile", function (result) {

        // create an array with nodes
        var nodes = new vis.DataSet();

        // create an array with edges
        var edges = new vis.DataSet();

        // create a network
        var container = document.getElementById('mynetwork');


        traverse(result.head, nodes, edges);

        var data = {
            nodes: nodes,
            edges: edges
        };
        var options = {};
        var network = new vis.Network(container, data, options);


        $("#time").attr({
            min: result.timestamps[0],
            max: result.timestamps[result.timestamps.length - 1],
        }).mousemove(function () {
            var selected = $(this).val();

            for (var i = 0; i < result.timestamps.length; i++) {
                if (selected <= result.timestamps[i]) {
                    console.log(selected, i, result.timestamps[i], result.samples[i]);
                    break;
                }
            }

        })

    })
</script>
<input id="time" type="range" style="width: 800px"/>
</body>
</html>