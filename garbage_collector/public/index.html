<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="../../lib/vis.css"/>
</head>
<body>
<h1>OneGC</h1>

<div id="root"></div>

<script src="../../lib/jquery-2.1.4.min.js"></script>
<script src="../../lib/vis.min.js"></script>
<script type="text/javascript">
    var ws = new WebSocket('ws://localhost:3002/');
    var ds = new vis.DataSet([]);
    var groups = new vis.DataSet();
    var container = document.getElementById("root");

    ["total_size_diff", "total_size_after","allocated"].forEach(function (name) {
        groups.add({
            id: name,
            content: name,
            options: {
                style: "bar",
                yAxisOrientation: "right",
                drawPoints: false,

            }
        })
    });

    var options = {
        start: Date.now(),
        end: Date.now() + 30000,
        legend: true,
        interpolation: false,
        stack: true,
    };

    var graph2d = new vis.Graph2d(container, ds, groups, options);

    ws.onmessage = function (e) {
        var nodes = JSON.parse(e.data);
        nodes.forEach(function (node) {
            if (!groups.get(node.group)) {
                groups.add({
                    id: node.group,
                    content: node.group
                });
            }
        })

        ds.add(nodes)
    }

</script>
</body>
</html>